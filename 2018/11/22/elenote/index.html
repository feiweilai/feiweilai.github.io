<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="vue-ele Note"><meta name="keywords" content=""><meta name="author" content="John Doe,undefined"><meta name="copyright" content="John Doe"><title>vue-ele Note | Hexo</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.3"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  localSearch: undefined
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#前四章-项目准备"><span class="toc-number">1.</span> <span class="toc-text">前四章 项目准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#前五章-骨架搭建"><span class="toc-number">2.</span> <span class="toc-text">前五章 骨架搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第六章-header组件"><span class="toc-number">3.</span> <span class="toc-text">第六章 header组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第七章-商品页面"><span class="toc-number">4.</span> <span class="toc-text">第七章 商品页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第八章-商品详情页"><span class="toc-number">5.</span> <span class="toc-text">第八章 商品详情页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第九章-评价页"><span class="toc-number">6.</span> <span class="toc-text">第九章 评价页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第十章-商家页"><span class="toc-number">7.</span> <span class="toc-text">第十章 商家页</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">John Doe</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">6</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container" style="background-image: url(true)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Hexo</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">vue-ele Note</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-11-22</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><h3 id="前四章-项目准备"><a href="#前四章-项目准备" class="headerlink" title="前四章 项目准备"></a>前四章 项目准备</h3><p>图标字体的创建<br>在iconfont/icomoon网站上传svg图片转成图标字体，在对应class的before伪类就会加上content<br>把字体文件放入common/font文件夹下，把字体文件中的style.css放入公共的common/stylus文件夹下<br>目录结构设计<br>每个组件文件夹管理自己的资源，common文件夹下放公共资源<br>在webpack.dev的devServer下可以模拟mock数据<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> appData = <span class="built_in">require</span>(<span class="string">'../data.json'</span>)</span><br><span class="line"><span class="keyword">const</span> seller = appData.seller</span><br><span class="line"><span class="keyword">const</span> goods = appData.goods</span><br><span class="line"><span class="keyword">const</span> ratings = appData.ratings</span><br><span class="line">devServer: &#123;</span><br><span class="line">    before(app) &#123;</span><br><span class="line">      app.get(<span class="string">'/api/seller'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        res.json(&#123;</span><br><span class="line">          errno: <span class="number">0</span>,</span><br><span class="line">          data: seller</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;);</span><br><span class="line">      app.get(<span class="string">'/api/goods'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        res.json(&#123;</span><br><span class="line">          errno: <span class="number">0</span>,</span><br><span class="line">          data: goods</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;);</span><br><span class="line">      app.get(<span class="string">'/api/ratings'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">        res.json(&#123;</span><br><span class="line">          errno: <span class="number">0</span>,</span><br><span class="line">          data: ratings</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<h3 id="前五章-骨架搭建"><a href="#前五章-骨架搭建" class="headerlink" title="前五章 骨架搭建"></a>前五章 骨架搭建</h3><p>引入移动端reset.css<br>在index.html head部分加上<link rel="stylesheet" type="text/css" href="static/css/reset.css"><br>加入移动端viewport设置<br> &lt;meta name=”viewport”content=”width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no”&gt;<br> 引用文件路径修改在webpack.base resolve/alias下<br> ‘components’: path.resolve(__dirname, ‘../src/components’)</p>
<p>vue-loader依赖postcss会解决一些css浏览器兼容性问题<br>tab栏三等分布局<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.tab</span></span><br><span class="line">  <span class="selector-tag">display</span> <span class="selector-tag">flex</span></span><br><span class="line">  <span class="selector-tag">height</span> 40<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">line-height</span> 40<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-class">.tab-item</span></span><br><span class="line">    <span class="selector-tag">flex</span> 1</span><br><span class="line">    <span class="selector-tag">text-align</span> <span class="selector-tag">center</span></span><br><span class="line">    &amp; &gt; a   //父元素下的a元素</span><br><span class="line">        <span class="selector-tag">display</span>: <span class="selector-tag">block</span></span><br><span class="line">        <span class="selector-tag">font-size</span>: 14<span class="selector-tag">px</span></span><br><span class="line">        <span class="selector-tag">color</span>: <span class="selector-tag">rgb</span>(77, 85, 93)</span><br><span class="line">        &amp;<span class="selector-class">.active</span></span><br><span class="line">          <span class="selector-tag">color</span>: <span class="selector-tag">rgb</span>(240, 20, 20)</span><br></pre></td></tr></table></figure></p>
<p>tab跳转用vue-router实现，linkActiveClass: ‘active’用来控制选中时的样式<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tab-item"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/goods"</span>&gt;</span>商品<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>要让a连接点击区域更大<br>1pxborder在dpi为2的移动端会显示2px，可以写在mixin中<br>元素的伪类相对于元素本身定位，在元素下方加一像素边框<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">border-1px($color)</span><br><span class="line">  <span class="selector-tag">position</span> <span class="selector-tag">relative</span></span><br><span class="line">  &amp;<span class="selector-pseudo">::after</span></span><br><span class="line">    <span class="selector-tag">display</span>: <span class="selector-tag">block</span></span><br><span class="line">    <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span></span><br><span class="line">    <span class="selector-tag">left</span> 0</span><br><span class="line">    <span class="selector-tag">bottom</span>: 0</span><br><span class="line">    border-top: 1px solid $color</span><br><span class="line">    <span class="selector-tag">width</span>: 100%</span><br><span class="line">    content: ''</span><br></pre></td></tr></table></figure></p>
<p>在base.styl中<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">media</span> (-webkit-min-device-pixel-ratio: <span class="number">1.5</span>),(min-device-pixel-ratio: <span class="number">1.5</span>)</span><br><span class="line">  .border-<span class="number">1px</span></span><br><span class="line">    &amp;::after</span><br><span class="line">      -webkit-transform: scaleY(<span class="number">0.7</span>)</span><br><span class="line">      transform: scaleY(<span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line">@media (-webkit-min-device-pixel-ratio: <span class="number">2</span>),(min-device-pixel-ratio: <span class="number">2</span>)</span><br><span class="line">  .border-<span class="number">1px</span></span><br><span class="line">    &amp;::after</span><br><span class="line">      -webkit-transform: scaleY(<span class="number">0.5</span>)</span><br><span class="line">      transform: scaleY(<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure></p>
<p><div class="tab border-1px"> 在main.js中引入index.styl</div></p>
<h3 id="第六章-header组件"><a href="#第六章-header组件" class="headerlink" title="第六章 header组件"></a>第六章 header组件</h3><p>在main.js中引入axios<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></span><br><span class="line">Vue.prototype.$http = axios</span><br></pre></td></tr></table></figure></p>
<p>图片和content用inline-block布局，父元素font-size设为0解决缝隙问题<br>在mixin.styl中加入bgImage选择不同dpi的图片<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bg-image($url)</span><br><span class="line">  background-image:  url($url + "@2x.png")</span><br><span class="line">  @<span class="keyword">media</span> (-webkit-min-device-pixel-ratio: <span class="number">3</span>),(min-device-pixel-ratio: <span class="number">3</span>)</span><br><span class="line">    background-image: url($url + <span class="string">"@3x.png"</span>)</span><br></pre></td></tr></table></figure></p>
<p>加载背景图片布局变为inline-block,指定宽高，再指定background-size，对齐用vertical-align,在base下设置公共样式<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>, <span class="selector-tag">html</span></span><br><span class="line">  <span class="selector-tag">line-height</span>: 1</span><br><span class="line">  <span class="selector-tag">font-weight</span>: 200</span><br><span class="line">  font-family: 'PingFang SC', 'STHeitiSC-Light', 'Helvetica-Light', arial, sans-serif</span><br></pre></td></tr></table></figure></p>
<p>文本折行<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">white-space</span>: <span class="selector-tag">nowrap</span></span><br><span class="line"><span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span></span><br><span class="line"><span class="selector-tag">text-overflow</span>: <span class="selector-tag">ellipsis</span></span><br></pre></td></tr></table></figure></p>
<p>公告右边的箭头图标使用绝对定位<br>header添加背景图片<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class="background"&gt;</span><br><span class="line">  &lt;img width="100%" height="100%" :src="seller.avatar"&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="selector-class">.background</span></span><br><span class="line">  <span class="selector-tag">position</span> <span class="selector-tag">absolute</span></span><br><span class="line">  <span class="selector-tag">left</span> 0</span><br><span class="line">  <span class="selector-tag">top</span> 0</span><br><span class="line">  <span class="selector-tag">width</span> 100%</span><br><span class="line">  <span class="selector-tag">height</span> 100%</span><br><span class="line">  <span class="selector-tag">z-index</span> <span class="selector-tag">-1</span></span><br><span class="line">  <span class="selector-tag">filter</span>: <span class="selector-tag">blur</span>(10<span class="selector-tag">px</span>)</span><br></pre></td></tr></table></figure></p>
<p>清除浮动<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.clearfix</span></span><br><span class="line">  <span class="selector-tag">display</span>: <span class="selector-tag">inline-block</span></span><br><span class="line">  &amp;<span class="selector-pseudo">:after</span></span><br><span class="line">    <span class="selector-tag">display</span>: <span class="selector-tag">block</span></span><br><span class="line">    <span class="selector-tag">content</span>: "."</span><br><span class="line">    <span class="selector-tag">height</span>: 0</span><br><span class="line">    <span class="selector-tag">line-height</span>: 0</span><br><span class="line">    <span class="selector-tag">clear</span>: <span class="selector-tag">both</span></span><br><span class="line">    <span class="selector-tag">visibility</span>: <span class="selector-tag">hidden</span></span><br></pre></td></tr></table></figure></p>
<p>弹出浮层使用fixed布局<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.detail</span></span><br><span class="line">  <span class="selector-tag">position</span> <span class="selector-tag">fixed</span></span><br><span class="line">  <span class="selector-tag">z-index</span> 100</span><br><span class="line">  <span class="selector-tag">left</span> 0</span><br><span class="line">  <span class="selector-tag">top</span> 0</span><br><span class="line">  <span class="selector-tag">width</span> 100%</span><br><span class="line">  <span class="selector-tag">height</span> 100%</span><br><span class="line">  <span class="selector-tag">background</span>: <span class="selector-tag">rgba</span>(7, 17, 27, 0<span class="selector-class">.8</span>)</span><br></pre></td></tr></table></figure></p>
<p>sticky footer<br>它们的顶层元素要加overflow auto<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class="detail-wrapper clearfix"&gt;</span><br><span class="line">  &lt;div class="detail-main"&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class="detail-close"&gt;</span><br><span class="line">  &lt;i class="icon-close"&gt;&lt;/i&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="selector-class">.detail-wrapper</span></span><br><span class="line">  <span class="selector-tag">min-height</span> 100%</span><br><span class="line">  <span class="selector-class">.detail-main</span></span><br><span class="line">    <span class="selector-tag">margin-top</span> 64<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">padding-bottom</span> 64<span class="selector-tag">px</span></span><br><span class="line"><span class="selector-class">.detail-close</span></span><br><span class="line">  <span class="selector-tag">position</span> <span class="selector-tag">relative</span></span><br><span class="line">  <span class="selector-tag">width</span> 32<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">height</span> 32<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">margin</span> <span class="selector-tag">-64px</span> <span class="selector-tag">auto</span> 0 <span class="selector-tag">auto</span></span><br><span class="line">  <span class="selector-tag">clear</span> <span class="selector-tag">both</span></span><br><span class="line">  <span class="selector-tag">font-size</span> 32<span class="selector-tag">px</span></span><br></pre></td></tr></table></figure></p>
<p>star组件的实现<br>//计算属性starType用于控制不同的尺寸，itemClass用来控制星是全还是半<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"star"</span> :<span class="class"><span class="keyword">class</span></span>=<span class="string">"starType"</span>&gt;</span><br><span class="line">  &lt;span v-<span class="keyword">for</span>=<span class="string">"itemClass in itemClasses"</span> :<span class="class"><span class="keyword">class</span></span>=<span class="string">"itemClass"</span>  <span class="class"><span class="keyword">class</span></span>=<span class="string">"star-item"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">props: &#123;</span></span><br><span class="line"><span class="regexp">    size: &#123;</span></span><br><span class="line"><span class="regexp">      type: Number</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    score: &#123;</span></span><br><span class="line"><span class="regexp">      type: Number</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">computed: &#123;</span></span><br><span class="line"><span class="regexp">  starType () &#123;</span></span><br><span class="line"><span class="regexp">    return 'star-' + this.size</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  itemClasses () &#123;</span></span><br><span class="line"><span class="regexp">    let result = []</span></span><br><span class="line"><span class="regexp">    let score = Math.floor(this.score * 2) /</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">let</span> hasDecimal = score % <span class="number">1</span> !== <span class="number">0</span></span><br><span class="line">    <span class="keyword">let</span> integer = <span class="built_in">Math</span>.floor(score)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; integer; i++) &#123;</span><br><span class="line">      result.push(CLS_ON)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (hasDecimal) &#123;</span><br><span class="line">      result.push(CLS_HALF)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (result.length &lt; LENGTH) &#123;</span><br><span class="line">      result.push(CLS_OFF)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//star-item之间inline-block，每一个用不同的背景图</span><br><span class="line"><span class="selector-class">.star</span></span><br><span class="line">  <span class="selector-tag">font-size</span> 0</span><br><span class="line">  <span class="selector-class">.star-item</span></span><br><span class="line">    <span class="selector-tag">display</span> <span class="selector-tag">inline-block</span></span><br><span class="line">  &amp;<span class="selector-class">.star-48</span></span><br><span class="line">    <span class="selector-class">.star-item</span></span><br><span class="line">      <span class="selector-tag">width</span>: 20<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">height</span>: 20<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">margin-right</span> 6<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">background-size</span> 20<span class="selector-tag">px</span> 20<span class="selector-tag">px</span></span><br><span class="line">      &amp;<span class="selector-pseudo">:last-child</span></span><br><span class="line">        <span class="selector-tag">margin-right</span>: 0</span><br><span class="line">      &amp;<span class="selector-class">.on</span></span><br><span class="line">        bg-image('star48_on')</span><br><span class="line">      &amp;<span class="selector-class">.half</span></span><br><span class="line">        bg-image('star48_half')</span><br><span class="line">      &amp;<span class="selector-class">.off</span></span><br><span class="line">        bg-image('star48_off')</span><br></pre></td></tr></table></figure>
<p>header调用star后怎么居中？<br>在wrapper设置text-align center<br>弹出层小标题要用flex布局<br>flex属性是flex-grow(指定元素空间占比),flex-shrink(当空间不足时等比缩小),flex-basis(可以指定具体的分配空间)，默认0 1 auto<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class="title"&gt;</span><br><span class="line">  &lt;div class="line"&gt;&lt;/div&gt;</span><br><span class="line">  &lt;div class="text"&gt;优惠信息&lt;/div&gt;</span><br><span class="line">  &lt;div class="line"&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="selector-class">.title</span></span><br><span class="line">  <span class="selector-tag">display</span> <span class="selector-tag">flex</span></span><br><span class="line">  <span class="selector-tag">width</span> 80%</span><br><span class="line">  <span class="selector-tag">margin</span>: 28<span class="selector-tag">px</span> <span class="selector-tag">auto</span> 24<span class="selector-tag">px</span> <span class="selector-tag">auto</span></span><br><span class="line">  <span class="selector-class">.line</span></span><br><span class="line">    <span class="selector-tag">flex</span> 1</span><br><span class="line">    position relative    //设置position top才有效果</span><br><span class="line">    <span class="selector-tag">border-bottom</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">rgba</span>(255, 255, 255, 0<span class="selector-class">.2</span>)</span><br><span class="line">    <span class="selector-tag">top</span> <span class="selector-tag">-6px</span></span><br><span class="line">  <span class="selector-class">.text</span></span><br><span class="line">    <span class="selector-tag">padding</span>: 0 12<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">font-weight</span>: 700</span><br><span class="line">    <span class="selector-tag">font-size</span>: 14<span class="selector-tag">px</span></span><br></pre></td></tr></table></figure></p>
<p>弹出层优惠信息布局<br>外层指定宽度，居中调margin,行内用inline-block，icon指定宽高，背景宽高，设定不同背景</p>
<h3 id="第七章-商品页面"><a href="#第七章-商品页面" class="headerlink" title="第七章 商品页面"></a>第七章 商品页面</h3><p>左侧导航栏固定宽度，右侧商品自适应，flex,要确定商品视口的高度，用绝对定位，<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.goods</span></span><br><span class="line">  <span class="selector-tag">position</span> <span class="selector-tag">absolute</span></span><br><span class="line">  <span class="selector-tag">display</span> <span class="selector-tag">flex</span></span><br><span class="line">  <span class="selector-tag">top</span>: 174<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">bottom</span>: 46<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">width</span>: 100%</span><br><span class="line">  <span class="selector-class">.menu-wrapper</span></span><br><span class="line">    <span class="selector-tag">flex</span> 0 0 80<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">width</span> 80<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">background</span> <span class="selector-id">#f3f5f7</span></span><br><span class="line">  <span class="selector-class">.foods-wrapper</span></span><br><span class="line">    <span class="selector-tag">flex</span> 1</span><br></pre></td></tr></table></figure></p>
<p>左侧菜单栏要水平垂直居中，如果用flex<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.menu-item</span></span><br><span class="line">  <span class="selector-tag">display</span> <span class="selector-tag">flex</span></span><br><span class="line">  <span class="selector-tag">align-items</span> <span class="selector-tag">center</span></span><br><span class="line">  <span class="selector-tag">justify-content</span> <span class="selector-tag">center</span></span><br><span class="line">  <span class="selector-tag">height</span>: 54<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">width</span>: 56<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">line-height</span> 14<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">margin</span> 0 12<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">border-1px</span>(<span class="selector-tag">rgba</span>(7, 17, 27, 0<span class="selector-class">.1</span>))</span><br></pre></td></tr></table></figure></p>
<p>如果用table布局<br>.menu-item<br>  display table<br>  height: 54px<br>  width: 56px<br>  line-height 14px<br>  padding  0 12px<br>  .text<br>    display table-cell<br>    font-size 12px<br>    vertical-align middle<br>    border-1px(rgba(7, 17, 27, 0.5))<br>右侧食品栏使用flex布局加margin，左侧图片固定宽度，每一类的食品分类标题加背景padding，border-left<br>要使ul能滚动起来，要用Bscroll,要用到DOM ref，当内部元素长度比视口长时可以滚动，因为DOM元素刷新的原因要用nextTick，<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">this</span>._initScroll();</span><br><span class="line">&#125;);</span><br><span class="line">_initScroll() &#123;</span><br><span class="line">  <span class="keyword">this</span>.meunScroll = <span class="keyword">new</span> BScroll(<span class="keyword">this</span>.$refs.menuWrapper, &#123;</span><br><span class="line">    click: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">this</span>.foodsScroll = <span class="keyword">new</span> BScroll(<span class="keyword">this</span>.$refs.foodsWrapper, &#123;</span><br><span class="line">    click: <span class="literal">true</span>,</span><br><span class="line">    probeType: <span class="number">3</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>菜单栏和食品栏的左右联动<br>在初始化Bscroll后，监听当前scrollY的位置,利用listHeight数组存放每一组食品的高度<br>Math.round四舍五入为整数<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.foodsScroll.on(<span class="string">'scroll'</span>, (pos) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 判断滑动方向，避免下拉时分类高亮错误（如第一分类商品数量为1时，下拉使得第二分类高亮）</span></span><br><span class="line">  <span class="keyword">if</span> (pos.y &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.scrollY = <span class="built_in">Math</span>.abs(<span class="built_in">Math</span>.round(pos.y));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"> _calculateHeight() &#123;</span><br><span class="line">  <span class="keyword">let</span> height = <span class="number">0</span></span><br><span class="line">  <span class="keyword">let</span> foodList = <span class="keyword">this</span>.$refs.foodList</span><br><span class="line">  <span class="keyword">this</span>.listHeight.push(height)</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i&lt;foodList.length;i++) &#123;</span><br><span class="line">    height += foodList[i].clientHeight</span><br><span class="line">    <span class="keyword">this</span>.listHeight.push(height)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当前分类随着滑动的变化而变化，用computed<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">currentIndex() &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="keyword">this</span>.listHeight.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> height1 = <span class="keyword">this</span>.listHeight[i];</span><br><span class="line">    <span class="keyword">let</span> height2 = <span class="keyword">this</span>.listHeight[i + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (!height2 || (<span class="keyword">this</span>.scrollY &gt;= height1 &amp;&amp; <span class="keyword">this</span>.scrollY &lt; height2)) &#123;</span><br><span class="line">      <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="selector-class">.current</span></span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">relative</span></span><br><span class="line">  <span class="selector-tag">margin-top</span>: <span class="selector-tag">-1px</span></span><br><span class="line">  <span class="selector-tag">background</span>: <span class="selector-id">#fff</span></span><br><span class="line">  <span class="selector-tag">font-weight</span>: 700</span><br><span class="line">  <span class="selector-class">.text</span></span><br><span class="line">    <span class="selector-tag">border-none</span>()</span><br></pre></td></tr></table></figure>
<p>点击菜单滚动到相应位置用到Bscroll接口，要拿到对应的DOM<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">selectMenu(index) &#123;</span><br><span class="line">  <span class="keyword">let</span> foodList = <span class="keyword">this</span>.$refs.foodList</span><br><span class="line">  <span class="keyword">let</span> el = foodList[index]</span><br><span class="line">  <span class="keyword">this</span>.foodsScroll.scrollToElement(el,<span class="number">300</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>购物车分为左右侧，用flex布局,右侧宽度固定<br>购物车图标wrapper相对自己向上偏移10px<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.content</span></span><br><span class="line">  <span class="selector-tag">display</span> <span class="selector-tag">flex</span></span><br><span class="line">  <span class="selector-tag">font-size</span> 0</span><br><span class="line">  <span class="selector-tag">background</span>: <span class="selector-id">#141d27</span></span><br><span class="line">  <span class="selector-class">.content-left</span></span><br><span class="line">    <span class="selector-tag">flex</span> 1</span><br><span class="line">    <span class="selector-class">.logo-wrapper</span></span><br><span class="line">      <span class="selector-tag">display</span> <span class="selector-tag">inline-block</span></span><br><span class="line">      <span class="selector-tag">position</span> <span class="selector-tag">relative</span></span><br><span class="line">      <span class="selector-tag">top</span> <span class="selector-tag">-10px</span></span><br><span class="line">      <span class="selector-tag">margin</span>: 0 12<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">padding</span>: 6<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">width</span>: 56<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">height</span>: 56<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">box-sizing</span> <span class="selector-tag">border-box</span></span><br><span class="line">      <span class="selector-tag">border-radius</span>: 50%</span><br><span class="line">      <span class="selector-tag">background</span>: <span class="selector-id">#141d27</span></span><br><span class="line">  <span class="selector-class">.content-right</span></span><br><span class="line">    <span class="selector-tag">flex</span> 0 0 105<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">width</span> 105<span class="selector-tag">px</span></span><br></pre></td></tr></table></figure></p>
<p>左侧几个内容都用inline-block<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.price</span></span><br><span class="line">  <span class="selector-tag">display</span> <span class="selector-tag">inline-block</span></span><br><span class="line">  <span class="selector-tag">vertical-align</span> <span class="selector-tag">top</span></span><br><span class="line">  <span class="selector-tag">margin-top</span>: 12<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">line-height</span>: 24<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">padding-right</span>: 12<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">border-right</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">rgba</span>(255, 255, 255, 0<span class="selector-class">.1</span>)</span><br><span class="line">  <span class="selector-tag">font-size</span>: 16<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">font-weight</span>: 700</span><br><span class="line">  <span class="selector-tag">color</span> <span class="selector-tag">rgba</span>(255,255,255,0<span class="selector-class">.4</span>)</span><br></pre></td></tr></table></figure></p>
<p>右边定宽部分指定text-align center，然后根据选中物品改变样式<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"logo"</span> <span class="attr">:class</span>=<span class="string">"&#123;'highlight':totalCount&gt;0&#125;"</span>&gt;</span></span><br><span class="line">&amp;.highlight</span><br><span class="line">  background: rgb(0, 160, 220)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line"> totalPrice() &#123;</span><br><span class="line">   <span class="keyword">let</span> total = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">this</span>.selectFoods.forEach(<span class="function">(<span class="params">food</span>) =&gt;</span> &#123;</span><br><span class="line">     total += food.price * food.count;</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="keyword">return</span> total;</span><br><span class="line"> &#125;,</span><br><span class="line"> totalCount() &#123;</span><br><span class="line">   <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">this</span>.selectFoods.forEach(<span class="function">(<span class="params">food</span>) =&gt;</span> &#123;</span><br><span class="line">     count += food.count;</span><br><span class="line">   &#125;);</span><br><span class="line">   <span class="keyword">return</span> count;</span><br><span class="line"> &#125;,</span><br><span class="line"> payDesc() &#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.totalPrice === <span class="number">0</span>) &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="string">`￥<span class="subst">$&#123;<span class="keyword">this</span>.minPrice&#125;</span>元起送`</span>;</span><br><span class="line">   &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.totalPrice &lt; <span class="keyword">this</span>.minPrice) &#123;</span><br><span class="line">     <span class="keyword">let</span> diff = <span class="keyword">this</span>.minPrice - <span class="keyword">this</span>.totalPrice;</span><br><span class="line">     <span class="keyword">return</span> <span class="string">`还差￥<span class="subst">$&#123;diff&#125;</span>元起送`</span>;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="string">'去结算'</span>;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;,</span><br><span class="line"> payClass() &#123;</span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">this</span>.totalPrice &lt; <span class="keyword">this</span>.minPrice) &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="string">'not-enough'</span>;</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="string">'enough'</span>;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>食品添加按钮组件使用字体图标,外层wrapper绝对定位，按钮间inline-block<br>cartcontrol中要给传来的food增加count属性<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">addCart() &#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">this</span>.food.count) &#123;</span><br><span class="line">    Vue.set(<span class="keyword">this</span>.food, <span class="string">'count'</span>, <span class="number">1</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.food.count++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>小球滚动动画减号需要两层DOM，外层负责平移，内层负责旋转<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cart-decrease"</span> <span class="attr">v-show</span>=<span class="string">"food.count&gt;0"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">click.stop.prevent</span>=<span class="string">"decreaseCart"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"inner icon-remove_circle_outline"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.cart-decrease</span></span><br><span class="line">  <span class="selector-tag">display</span>: <span class="selector-tag">inline-block</span></span><br><span class="line">  <span class="selector-tag">padding</span>: 6<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">opacity</span> 1</span><br><span class="line">  <span class="selector-tag">transform</span> <span class="selector-tag">translate3d</span>(0,0,0)</span><br><span class="line">  <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.4s</span> <span class="selector-tag">linear</span></span><br><span class="line">  <span class="selector-class">.inner</span></span><br><span class="line">    <span class="selector-tag">display</span> <span class="selector-tag">inline-block</span></span><br><span class="line">    <span class="selector-tag">line-height</span>: 24<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">font-size</span>: 24<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">color</span>: <span class="selector-tag">rgb</span>(0, 160, 220)</span><br><span class="line">    <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.4s</span> <span class="selector-tag">linear</span></span><br><span class="line">    <span class="selector-tag">transform</span>: <span class="selector-tag">rotate</span>(0)</span><br><span class="line">  &amp;<span class="selector-class">.move-enter</span>, &amp;<span class="selector-class">.move-leave-active</span></span><br><span class="line">    <span class="selector-tag">opacity</span>: 0</span><br><span class="line">    <span class="selector-tag">transform</span>: <span class="selector-tag">translate3d</span>(24<span class="selector-tag">px</span>, 0, 0)</span><br><span class="line">    <span class="selector-class">.inner</span></span><br><span class="line">      <span class="selector-tag">transform</span>: <span class="selector-tag">rotate</span>(180<span class="selector-tag">deg</span>)</span><br></pre></td></tr></table></figure>
<p>goods页面要传给shopcart selectFoods,selectFoods要检查每个food的count,用computed<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">selectFoods() &#123;</span><br><span class="line">  <span class="keyword">let</span> foods = [];</span><br><span class="line">  <span class="keyword">this</span>.goods.forEach(<span class="function">(<span class="params">good</span>) =&gt;</span> &#123;</span><br><span class="line">    good.foods.forEach(<span class="function">(<span class="params">food</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (food.count) &#123;</span><br><span class="line">        foods.push(food);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> foods;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>food作为对象传给了cartcontrol,Vue.set(this.food, ‘count’, 1),改变了food的内容影响了父组件，<br>父组件computed重新计算</p>
<p>购物车详情页<br>因为购物列表相对于购物车组件向上展开，使用绝对定位，本身是相对于购物车的，利用transform属性使其平移<br>向上展开，设置z-index是为了显示购物车logo<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.shopcart-list</span></span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span></span><br><span class="line">  <span class="selector-tag">left</span>: 0</span><br><span class="line">  <span class="selector-tag">top</span>: 0</span><br><span class="line">  <span class="selector-tag">z-index</span>: <span class="selector-tag">-1</span></span><br><span class="line">  <span class="selector-tag">width</span>: 100%</span><br><span class="line">  <span class="selector-tag">transform</span>: <span class="selector-tag">translate3d</span>(0, <span class="selector-tag">-100</span>%, 0)</span><br></pre></td></tr></table></figure></p>
<p>购物车蒙层与购物车同级，使用fixed定位,设置z-index保证购物车列表在上<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.list-mask</span></span><br><span class="line">  <span class="selector-tag">position</span> <span class="selector-tag">fixed</span></span><br><span class="line">  <span class="selector-tag">left</span> 0</span><br><span class="line">  <span class="selector-tag">top</span> 0</span><br><span class="line">  <span class="selector-tag">width</span> 100%</span><br><span class="line">  <span class="selector-tag">height</span> 100%</span><br><span class="line">  <span class="selector-tag">background</span>: <span class="selector-tag">rgba</span>(7, 17, 27, 0<span class="selector-class">.6</span>)</span><br><span class="line">  <span class="selector-tag">z-index</span> 40</span><br></pre></td></tr></table></figure></p>
<h3 id="第八章-商品详情页"><a href="#第八章-商品详情页" class="headerlink" title="第八章 商品详情页"></a>第八章 商品详情页</h3><p>整个布局用fixed,头部图片要宽高相等，异步加载不抖动，图片容器设置高度为0和padding-top 100%，<br>内部图片绝对布局，指定宽高,加入购物车图标用v-show控制<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.food</span></span><br><span class="line">  <span class="selector-tag">position</span> <span class="selector-tag">fixed</span></span><br><span class="line">  <span class="selector-tag">left</span> 0</span><br><span class="line">  <span class="selector-tag">top</span> 0</span><br><span class="line">  <span class="selector-tag">bottom</span> 48<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">width</span> 100%</span><br><span class="line">  <span class="selector-tag">background</span> <span class="selector-id">#fff</span></span><br><span class="line">  <span class="selector-class">.image-header</span></span><br><span class="line">    <span class="selector-tag">position</span> <span class="selector-tag">relative</span></span><br><span class="line">    <span class="selector-tag">width</span> 100%</span><br><span class="line">    <span class="selector-tag">height</span> 0</span><br><span class="line">    <span class="selector-tag">padding-top</span> 100%</span><br><span class="line">    <span class="selector-tag">img</span></span><br><span class="line">      <span class="selector-tag">position</span> <span class="selector-tag">absolute</span></span><br><span class="line">      <span class="selector-tag">left</span> 0</span><br><span class="line">      <span class="selector-tag">top</span> 0</span><br><span class="line">      <span class="selector-tag">width</span> 100%</span><br><span class="line">      <span class="selector-tag">height</span> 100%</span><br></pre></td></tr></table></figure></p>
<p>加入购物车按钮样式<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.buy</span></span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span></span><br><span class="line">  <span class="selector-tag">right</span>: 18<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">bottom</span>: 18<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">padding</span>: 0 12<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">border-radius</span>: 12<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">color</span>: <span class="selector-id">#fff</span></span><br><span class="line">  <span class="selector-tag">background</span>: <span class="selector-tag">rgb</span>(0, 160, 220)</span><br><span class="line">  <span class="selector-tag">height</span>: 24<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">line-height</span>: 24<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">font-size</span>: 10<span class="selector-tag">px</span></span><br></pre></td></tr></table></figure></p>
<p>ratingselect组件 只包括切换模块，不包括评价列表<br>分为选择评价块和内容块，选择评价块用inline-block<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.ratingselect</span></span><br><span class="line">  <span class="selector-class">.rating-type</span></span><br><span class="line">    <span class="selector-tag">padding</span> 18<span class="selector-tag">px</span> 0</span><br><span class="line">    <span class="selector-tag">margin</span>: 0 18<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">border-1px</span>(<span class="selector-tag">rgba</span>(7, 17, 27, 0<span class="selector-class">.1</span>))</span><br><span class="line">    <span class="selector-tag">font-size</span> 0</span><br><span class="line">    <span class="selector-class">.block</span></span><br><span class="line">      <span class="selector-tag">display</span>: <span class="selector-tag">inline-block</span></span><br><span class="line">      <span class="selector-tag">padding</span>: 8<span class="selector-tag">px</span> 12<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">margin-right</span>: 8<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">line-height</span>: 16<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">border-radius</span>: 1<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">font-size</span>: 12<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">color</span>: <span class="selector-tag">rgb</span>(77, 85, 93)</span><br><span class="line">      <span class="selector-class">.count</span></span><br><span class="line">        <span class="selector-tag">margin-left</span>: 2<span class="selector-tag">px</span></span><br><span class="line">        <span class="selector-tag">font-size</span>: 8<span class="selector-tag">px</span></span><br><span class="line">      &amp;<span class="selector-class">.active</span></span><br><span class="line">        <span class="selector-tag">color</span>: <span class="selector-id">#fff</span></span><br><span class="line">      &amp;<span class="selector-class">.positive</span></span><br><span class="line">        <span class="selector-tag">background</span>: <span class="selector-tag">rgba</span>(0, 160, 220, 0<span class="selector-class">.2</span>)</span><br><span class="line">        &amp;<span class="selector-class">.active</span></span><br><span class="line">          <span class="selector-tag">background</span>: <span class="selector-tag">rgb</span>(0, 160, 220)</span><br><span class="line">      &amp;<span class="selector-class">.negative</span></span><br><span class="line">        <span class="selector-tag">background</span>: <span class="selector-tag">rgba</span>(77, 85, 93, 0<span class="selector-class">.2</span>)</span><br><span class="line">        &amp;<span class="selector-class">.active</span></span><br><span class="line">          <span class="selector-tag">background</span>: <span class="selector-tag">rgb</span>(77, 85, 93)</span><br></pre></td></tr></table></figure></p>
<p>不要直接改变父组件传来的属性， this.$emit(‘select’, 参数);在父组件监听改变属性<br>筛选正面评价数用computed<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">positives() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.ratings.filter(<span class="function">(<span class="params">rating</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> rating.rateType === POSITIVE;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>class绑定变量来改变样式<br>列表外有wrapper设置padding,在li中设置padding和border，头像用户名用绝对定位，inline-block<br>列表要筛选对应的类型，li上加needShow函数<br>父组件收到子组件属性改变后Bscroll要刷新<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">needShow(type, text) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.onlyContent &amp;&amp; !text) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.selectType === ALL) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> type === <span class="keyword">this</span>.selectType;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当要加下边框实线时，要两边空出来，元素加margin，要是100%宽度，元素加padding<br>把时间戳转化为时间字符串,利用vue的filter<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"time"</span>&gt;&#123;&#123;rating.rateTime | formatDate&#125;&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">filters: &#123;</span></span><br><span class="line"><span class="regexp">  formatDate(time) &#123;</span></span><br><span class="line"><span class="regexp">    let date = new Date(time);</span></span><br><span class="line"><span class="regexp">    return formatDate(date, 'yyyy-MM-dd hh:mm');</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/开始匹配以y开头一个或多个的字符串，$1为括号里的匹配值，替换匹配到的值</span></span><br><span class="line"><span class="regexp">export function formatDate (date, fmt) &#123;</span></span><br><span class="line"><span class="regexp">  if (/</span>(y+)/.test(fmt)) &#123;</span><br><span class="line">    fmt = fmt.replace(</span><br><span class="line">      <span class="built_in">RegExp</span>.$<span class="number">1</span>,</span><br><span class="line">      (date.getFullYear() + <span class="string">''</span>).substr(<span class="number">4</span> - <span class="built_in">RegExp</span>.$<span class="number">1.</span>length)</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> o = &#123;</span><br><span class="line">    <span class="string">'M+'</span>: date.getMonth() + <span class="number">1</span>,</span><br><span class="line">    <span class="string">'d+'</span>: date.getDate(),</span><br><span class="line">    <span class="string">'h+'</span>: date.getHours(),</span><br><span class="line">    <span class="string">'m+'</span>: date.getMinutes(),</span><br><span class="line">    <span class="string">'s+'</span>: date.getSeconds()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">in</span> o) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">`(<span class="subst">$&#123;k&#125;</span>)`</span>).test(fmt)) &#123;</span><br><span class="line">      <span class="keyword">let</span> str = o[k] + <span class="string">''</span></span><br><span class="line">      fmt = fmt.replace(</span><br><span class="line">        <span class="built_in">RegExp</span>.$<span class="number">1</span>,</span><br><span class="line">        <span class="built_in">RegExp</span>.$<span class="number">1.</span>length === <span class="number">1</span> ? str : padLeftZero(str)</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fmt</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="第九章-评价页"><a href="#第九章-评价页" class="headerlink" title="第九章 评价页"></a>第九章 评价页</h3><p>overview用flex布局，左边定宽，行内用inline-block，<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"overview-right"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"score-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>服务态度<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">star</span> <span class="attr">:size</span>=<span class="string">"36"</span> <span class="attr">:score</span>=<span class="string">"seller.serviceScore"</span>&gt;</span><span class="tag">&lt;/<span class="name">star</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"score"</span>&gt;</span>&#123;&#123;seller.serviceScore&#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"delivery-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span>送达时间<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"delivery"</span>&gt;</span>&#123;&#123;seller.deliveryTime&#125;&#125;分钟<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.ratings</span></span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span></span><br><span class="line">  <span class="selector-tag">top</span>: 174<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">bottom</span>: 0</span><br><span class="line">  <span class="selector-tag">left</span>: 0</span><br><span class="line">  <span class="selector-tag">width</span>: 100%</span><br><span class="line">  <span class="selector-tag">overflow</span> <span class="selector-tag">hidden</span></span><br><span class="line">  <span class="selector-class">.overview</span></span><br><span class="line">    <span class="selector-tag">display</span> <span class="selector-tag">flex</span></span><br><span class="line">    <span class="selector-tag">padding</span> 18<span class="selector-tag">px</span> 0</span><br></pre></td></tr></table></figure>
<p>text-indent用来控制input文字的位置<br>评论列表用flex，左边头像定宽，右边内容自适应，time用绝对定位</p>
<h3 id="第十章-商家页"><a href="#第十章-商家页" class="headerlink" title="第十章 商家页"></a>第十章 商家页</h3><p>最外层wrapper布局和评价页相似</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.remark</span></span><br><span class="line">  <span class="selector-tag">display</span> <span class="selector-tag">flex</span></span><br><span class="line">  <span class="selector-tag">text-align</span> <span class="selector-tag">center</span></span><br><span class="line">  <span class="selector-tag">padding-top</span>: 18<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-class">.block</span></span><br><span class="line">    <span class="selector-tag">flex</span> 1</span><br><span class="line">    <span class="selector-tag">border-right</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">rgba</span>(7, 17, 27, 0<span class="selector-class">.1</span>)</span><br><span class="line">    &amp;<span class="selector-pseudo">:last-child</span></span><br><span class="line">      <span class="selector-tag">border</span>: <span class="selector-tag">none</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  <span class="string">'seller'</span>() &#123;</span><br><span class="line">    <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>._initScroll();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">mounted() &#123;</span><br><span class="line">  <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>._initScroll();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">  _initScroll() &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">this</span>.scroll) &#123;</span><br><span class="line">      <span class="keyword">this</span>.scroll = <span class="keyword">new</span> BScroll(<span class="keyword">this</span>.$refs.seller, &#123;</span><br><span class="line">        click: <span class="literal">true</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.scroll.refresh();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>商家实景<br>横向Bscroll要手动设置图片列表的宽度，<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.pic-wrapper</span></span><br><span class="line">  <span class="selector-tag">width</span>: 100%</span><br><span class="line">  <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span></span><br><span class="line">  <span class="selector-tag">white-space</span>: <span class="selector-tag">nowrap</span></span><br><span class="line">  <span class="selector-class">.pic-list</span></span><br><span class="line">    <span class="selector-tag">font-size</span>: 0</span><br><span class="line">    <span class="selector-class">.pic-item</span></span><br><span class="line">      <span class="selector-tag">display</span>: <span class="selector-tag">inline-block</span></span><br><span class="line">      <span class="selector-tag">margin-right</span>: 6<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">width</span>: 120<span class="selector-tag">px</span></span><br><span class="line">      <span class="selector-tag">height</span>: 90<span class="selector-tag">px</span></span><br><span class="line">      &amp;<span class="selector-pseudo">:last-child</span></span><br><span class="line">        <span class="selector-tag">margin</span>: 0</span><br></pre></td></tr></table></figure></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">_initPics() &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>.seller.pics) &#123;</span><br><span class="line">    <span class="keyword">let</span> picWidth = <span class="number">120</span>;</span><br><span class="line">    <span class="keyword">let</span> margin = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">let</span> width = (picWidth + margin) * <span class="keyword">this</span>.seller.pics.length - margin;</span><br><span class="line">    <span class="keyword">this</span>.$refs.picList.style.width = width + <span class="string">'px'</span>;</span><br><span class="line">    <span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!<span class="keyword">this</span>.picScroll) &#123;</span><br><span class="line">        <span class="keyword">this</span>.picScroll = <span class="keyword">new</span> BScroll(<span class="keyword">this</span>.$refs.picWrapper, &#123;</span><br><span class="line">          scrollX: <span class="literal">true</span>,</span><br><span class="line">          eventPassthrough: <span class="string">'vertical'</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.picScroll.refresh();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>收藏按钮<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.favorite</span></span><br><span class="line">  <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span></span><br><span class="line">  <span class="selector-tag">width</span> 50<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">right</span>: 11<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">top</span>: 18<span class="selector-tag">px</span></span><br><span class="line">  <span class="selector-tag">text-align</span> <span class="selector-tag">center</span></span><br><span class="line">  <span class="selector-class">.icon-favorite</span></span><br><span class="line">    <span class="selector-tag">display</span> <span class="selector-tag">block</span></span><br><span class="line">    <span class="selector-tag">font-size</span>: 24<span class="selector-tag">px</span></span><br><span class="line">    <span class="selector-tag">color</span>: <span class="selector-id">#d4d6d9</span></span><br><span class="line">    &amp;<span class="selector-class">.active</span></span><br><span class="line">      <span class="selector-tag">color</span>: <span class="selector-tag">rgb</span>(240, 20, 20)</span><br></pre></td></tr></table></figure></p>
<p>获取商家信息时要加上id<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 解析url参数</span></span><br><span class="line"><span class="comment"> * @example ?id=12345&amp;a=b</span></span><br><span class="line"><span class="comment"> * @return Object &#123;id:12345,a:b&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">urlParse</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> url = <span class="built_in">window</span>.location.search</span><br><span class="line">  <span class="keyword">let</span> obj = &#123;&#125;</span><br><span class="line">  <span class="keyword">let</span> reg = <span class="regexp">/[?&amp;][^?&amp;]+=[^?&amp;]+/g</span></span><br><span class="line">  <span class="keyword">let</span> arr = url.match(reg)</span><br><span class="line">  <span class="comment">// ['?id=12345', '&amp;a=b']</span></span><br><span class="line">  <span class="keyword">if</span>(arr)&#123;</span><br><span class="line">    arr.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> tmpArr = item.substr(<span class="number">1</span>).split(<span class="string">'='</span>)</span><br><span class="line">      <span class="keyword">let</span> key = <span class="built_in">decodeURIComponent</span>(tmpArr[<span class="number">0</span>])</span><br><span class="line">      <span class="keyword">let</span> value = <span class="built_in">decodeURIComponent</span>(tmpArr[<span class="number">1</span>])</span><br><span class="line">      obj[key] = value</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> obj</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在开始seller中要用立即执行函数取出id<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">data () &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    seller: &#123;</span><br><span class="line">      id: <span class="function">(<span class="params">(</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> queryParam = urlParse();</span><br><span class="line">        <span class="keyword">return</span> queryParam.id;</span><br><span class="line">      &#125;)()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//赋值时要保留id</span></span><br><span class="line"><span class="keyword">if</span> (response.errno === ERR_OK) &#123;</span><br><span class="line">  <span class="keyword">this</span>.seller = <span class="built_in">Object</span>.assign(&#123;&#125;, <span class="keyword">this</span>.seller, response.data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>写了localStorage的通用存取方案<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">saveToLocal</span>(<span class="params">id,key,value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> seller = <span class="built_in">window</span>.localStorage.__seller__</span><br><span class="line">  <span class="keyword">if</span>(!seller)&#123;</span><br><span class="line">    seller = &#123;&#125;</span><br><span class="line">    seller[id] = &#123;&#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    seller = <span class="built_in">JSON</span>.parse(seller)</span><br><span class="line">    <span class="keyword">if</span>(!seller[id])&#123;</span><br><span class="line">      seller[id] = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  seller[id][key] = value</span><br><span class="line">  <span class="built_in">window</span>.localStorage.__seller__ = <span class="built_in">JSON</span>.stringify(seller)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">loadFromLocal</span>(<span class="params">id,key,def</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> seller = <span class="built_in">window</span>.localStorage.__seller__;</span><br><span class="line">	<span class="keyword">if</span> (!seller) &#123;</span><br><span class="line">		<span class="keyword">return</span> def;</span><br><span class="line">	&#125;</span><br><span class="line">	seller = <span class="built_in">JSON</span>.parse(seller)[id];</span><br><span class="line">	<span class="keyword">if</span> (!seller) &#123;</span><br><span class="line">		<span class="keyword">return</span> def;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">let</span> ret = seller[key];</span><br><span class="line">	<span class="keyword">return</span> ret || def;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>切换组件保留之前组件状态，可以少发请求</p>
<p><keep-alive><br>  <router-view :seller="seller"></router-view><br></keep-alive></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">John Doe</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/11/22/elenote/">http://yoursite.com/2018/11/22/elenote/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"></div><nav id="pagination"><div class="next-post pull-right"><a href="/2018/11/22/cssnote/"><span>css Note</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2018 By John Doe</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.3"></script><script src="/js/fancybox.js?version=1.5.3"></script><script src="/js/sidebar.js?version=1.5.3"></script><script src="/js/copy.js?version=1.5.3"></script><script src="/js/fireworks.js?version=1.5.3"></script><script src="/js/transition.js?version=1.5.3"></script><script src="/js/scroll.js?version=1.5.3"></script><script src="/js/head.js?version=1.5.3"></script></body></html>